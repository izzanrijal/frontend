import{b as e,r as a,V as s,Z as r,c as t,l,O as o,B as n,v as i,D as d,u,A as m,P as c,a2 as p,W as f,R as v,S as w,$ as g,a0 as h}from"./vendor-BrUfZ_qe.js";import{_ as y}from"./AuthProvider-BvwJsq9J.js";import{l as _}from"./berkompeten_logo-DMPmA03r.js";import{a as b,b as x}from"./auth-v1-mask-light-Dw7KYw8D.js";import{a as V,b as j}from"./auth-v1-tree-E4nls1uH.js";import{a as k}from"./axios-fZjk1EK6.js";import{_ as I,g as S}from"./index-DWDInlzl.js";import{V as q,c as C,e as P,a as A,b as L}from"./VCard-qw0e-7-C.js";import{V as E}from"./VImg-3tLKbNbK.js";import{V as H,a as R}from"./VForm-CXP0buYo.js";import{V as T}from"./VDivider-RnoMw8o6.js";import{J as U}from"./vuetify-BGzDg8SZ.js";import"./VGrid-CbeiMOBg.js";import"./index-xgti94jS.js";import"./VInput-Ct12ZIFv.js";import"./forwardRefs-BiNqQvLW.js";const D=e=>(g("data-v-94010e1d"),e=e(),h(),e),F={class:"auth-wrapper d-flex align-center justify-center pa-4"},J={class:"d-flex"},M=["innerHTML"],N=D((()=>c("div",{class:"d-flex align-center mt-1 mb-4"},null,-1))),$=D((()=>c("div",{id:"turnstile-container-register",class:"mb-2"},null,-1))),z={key:0,class:"mt-2 text-danger",style:{color:"#ff5252"}},B=D((()=>c("span",null,"Already have an account?",-1))),G=D((()=>c("span",{class:"mx-4"},"or",-1))),K=I({__name:"register",setup(g){const h=e(null),I=a({username:"",email:"",password:"",confirm_password:"",privacyPolicies:!1}),D=U(),K=s(),O=r(),W=t((()=>"light"===D.global.name.value?b:x)),Z=e(!1),Q=e(!1),X=e(null),Y=()=>{window.turnstile?(h.value&&window.turnstile.remove(h.value),h.value=window.turnstile.render("#turnstile-container-register",{sitekey:"1x00000000000000000000AA",theme:"light",callback:function(e){var a;const s=document.createElement("input");s.type="hidden",s.name="cf-turnstile-response",s.value=e;const r=document.querySelector('input[name="cf-turnstile-response"]');r&&r.remove(),null==(a=document.querySelector("form"))||a.appendChild(s)},"expired-callback":()=>{Y()},"error-callback":()=>{},appearance:"interaction-only"})):setTimeout(Y,500)},ee=async()=>{var e;if(X.value="",""==I.email)return void(X.value="email is required");if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(I.email))return void(X.value="Invalid email format");if(""==I.password)return void(X.value="password is required");if(I.password.length<8)return void(X.value="password length must be 8 character or more");if(""==I.confirm_password)return void(X.value="confirm password is required");if(I.confirm_password.length<8)return void(X.value="confirm password length must be 8 character or more");if(I.password!==I.confirm_password)return void(X.value="Password and confirm password do not match");const a=null==(e=document.querySelector('[name="cf-turnstile-response"]'))?void 0:e.value,s={email:I.email,password:I.password};a&&(s["cf-turnstile-response"]=a);try{await k.post("https://gateway.berkompeten.id/api/student/register/step/1",s);localStorage.setItem("email",I.email),localStorage.setItem("password",I.password),localStorage.setItem("confirm_password",I.confirm_password),K.push("/register-step-2")}catch(r){if(r.response&&r.response.data){if(r.response.data.errors.email)return void(X.value=r.response.data.errors.email[0]);if(429===r.response.status||r.response.data.errors&&"string"==typeof r.response.data.errors&&r.response.data.errors.toLowerCase().includes("captcha"))return Y(),void(X.value="Please try again");X.value=r.response.data.errors}}};return l((()=>{const e=localStorage.getItem("email"),a=O.query.email,s=O.query.name;a&&(I.email=a,localStorage.setItem("email",I.email),localStorage.setItem("name",s),K.push("/register")),e&&(I.email=e),Y()})),(e,a)=>{const s=m("RouterLink");return n(),o("div",F,[i(q,{class:"auth-card pa-4 pt-7","max-width":"448"},{default:d((()=>[i(C,{class:"justify-center"},{prepend:d((()=>[c("div",J,[c("div",{innerHTML:u(_)},null,8,M)])])),_:1}),i(P,null,{default:d((()=>[i(H,{onSubmit:p((()=>{}),["prevent"])},{default:d((()=>[i(A,null,{default:d((()=>[i(L,{cols:"12"},{default:d((()=>[i(R,{modelValue:I.email,"onUpdate:modelValue":a[0]||(a[0]=e=>I.email=e),label:"Email",placeholder:"example@email.com",type:"email"},null,8,["modelValue"])])),_:1}),i(L,{cols:"12"},{default:d((()=>[i(R,{modelValue:I.password,"onUpdate:modelValue":a[1]||(a[1]=e=>I.password=e),label:"Password",placeholder:"············",type:Z.value?"text":"password","append-inner-icon":Z.value?"ri-eye-off-line":"ri-eye-line","onClick:appendInner":a[2]||(a[2]=e=>Z.value=!Z.value)},null,8,["modelValue","type","append-inner-icon"])])),_:1}),i(L,{cols:"12"},{default:d((()=>[i(R,{modelValue:I.confirm_password,"onUpdate:modelValue":a[3]||(a[3]=e=>I.confirm_password=e),label:"Confirm Password",placeholder:"············",type:Q.value?"text":"password","append-inner-icon":Q.value?"ri-eye-off-line":"ri-eye-line","onClick:appendInner":a[4]||(a[4]=e=>Q.value=!Q.value)},null,8,["modelValue","type","append-inner-icon"]),N,$,i(S,{block:"",type:"submit",color:"#0080ff",onClick:ee},{default:d((()=>[v(" Next ")])),_:1}),X.value?(n(),o("div",z,w(X.value),1)):f("",!0)])),_:1}),i(L,{cols:"12",class:"text-center text-base"},{default:d((()=>[B,i(s,{class:"text-primary ms-2",to:"login"},{default:d((()=>[v(" Sign in instead ")])),_:1})])),_:1}),i(L,{cols:"12",class:"d-flex align-center"},{default:d((()=>[i(T),G,i(T)])),_:1}),i(L,{cols:"12",class:"text-center"},{default:d((()=>[i(y)])),_:1})])),_:1})])),_:1})])),_:1})])),_:1}),i(E,{class:"auth-footer-start-tree d-none d-md-block",src:u(V),width:250},null,8,["src"]),i(E,{src:u(j),class:"auth-footer-end-tree d-none d-md-block",width:350},null,8,["src"]),i(E,{class:"auth-footer-mask d-none d-md-block",src:W.value},null,8,["src"])])}}},[["__scopeId","data-v-94010e1d"]]);export{K as default};
