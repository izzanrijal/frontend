import{b as e,V as a,r as s,c as t,l as r,O as l,B as o,v as n,D as i,A as u,P as d,u as m,a2 as c,z as p,W as f,F as v,X as g,R as w,S as b,$ as h,a0 as y}from"./vendor-BrUfZ_qe.js";import{_ as V}from"./AuthProvider-BvwJsq9J.js";import{l as _}from"./berkompeten_logo-DMPmA03r.js";import{a as j,b as x}from"./auth-v1-mask-light-Dw7KYw8D.js";import{a as k}from"./axios-fZjk1EK6.js";import{_ as S,g as I}from"./index-DWDInlzl.js";import{V as C,c as L,e as q,a as A,b as E}from"./VCard-qw0e-7-C.js";import{V as P,a as F}from"./VForm-CXP0buYo.js";import{a as M,V as T}from"./VList-aJ-Y5r4c.js";import{V as B}from"./VListItemTitle-GAILHzRm.js";import{V as H}from"./VCheckbox-Das_GRap.js";import{V as J}from"./VDivider-RnoMw8o6.js";import{J as R}from"./vuetify-BGzDg8SZ.js";import"./VGrid-CbeiMOBg.js";import"./VImg-3tLKbNbK.js";import"./index-xgti94jS.js";import"./VInput-Ct12ZIFv.js";import"./forwardRefs-BiNqQvLW.js";import"./ssrBoot-B8jrVcKx.js";import"./VSelectionControl-BqiqHV3m.js";const D=e=>(h("data-v-a5d6fe46"),e=e(),y(),e),N={class:"auth-wrapper d-flex align-center justify-center pa-4"},O={class:"d-flex"},U=["innerHTML"],z=D((()=>d("h5",{class:"text-h5 font-weight-semibold mb-1"}," Hai Selamat Datang! ",-1))),G=D((()=>d("p",{class:"mb-0"}," Please sign-in to your account and start the adventure ",-1))),K={class:"d-flex align-center justify-space-between flex-wrap mt-1 mb-4"},W=D((()=>d("div",{id:"turnstile-container",class:"mb-2"},null,-1))),X={key:0,class:"mt-2 text-danger",style:{color:"#ff5252"}},$=D((()=>d("span",null,"New on our platform?",-1))),Q=D((()=>d("span",{class:"mx-4"},"or",-1))),Y=S({__name:"login",setup(h){const y=e(null),S=a(),D=s({email:"",password:"",remember:!1}),Y=e([]),Z=R(),ee=e(!1),ae=e([]);t((()=>"light"===Z.global.name.value?j:x));const se=e(!1),te=e(null);var re=localStorage.getItem("token");const le=()=>{const e=D.email.toLowerCase();ae.value=Y.value.filter((a=>a.toLowerCase().includes(e)))},oe=()=>{setTimeout((()=>ee.value=!1),200)},ne=()=>{window.turnstile?(y.value&&window.turnstile.remove(y.value),y.value=window.turnstile.render("#turnstile-container",{sitekey:"1x00000000000000000000AA",theme:"light",callback:function(e){var a;const s=document.createElement("input");s.type="hidden",s.name="cf-turnstile-response",s.value=e;const t=document.querySelector('input[name="cf-turnstile-response"]');t&&t.remove(),null==(a=document.querySelector("form"))||a.appendChild(s)},"expired-callback":()=>{ne()},"error-callback":()=>{},appearance:"interaction-only"})):setTimeout(ne,500)};r((async()=>{re&&S.push("/dashboard");const e=JSON.parse(localStorage.getItem("savedEmails"))||[];Y.value=e,ne()}));const ie=async()=>{var e,a;try{if(""===D.email)return void(te.value="email is required");if(""===D.password)return void(te.value="password is required");if(D.password.length<8)return void(te.value="password length must be 8 character or more");let s=null;s=null==(e=document.querySelector('[name="cf-turnstile-response"]'))?void 0:e.value;const t={email:D.email,password:D.password};s&&(t["cf-turnstile-response"]=s);const r="https://gateway.berkompeten.id/api/student/login",l=(await k.post(r,t)).data.token;localStorage.setItem("token",l),a=D.email,Y.value.includes(a)||(Y.value.push(a),localStorage.setItem("savedEmails",JSON.stringify(Y.value))),S.push("/dashboard")}catch(s){return s.response&&s.response.data?(te.value=s.response.data.message,s.response.data.errors&&(te.value=s.response.data.errors),(429===s.response.status||s.response.data.errors&&"string"==typeof s.response.data.errors&&s.response.data.errors.toLowerCase().includes("captcha"))&&(ne(),te.value="Please try again"),void(!1===s.response.data.is_exist&&(localStorage.setItem("email",D.email),S.push("/register")))):(te.value="An unexpected error occurred during login.",void s.request)}},ue=()=>{S.push("/forgot-password")};return(e,a)=>{const s=u("RouterLink");return o(),l("div",N,[n(C,{class:"auth-card pa-4 pt-7","max-width":"448"},{default:i((()=>[n(L,{class:"justify-center"},{prepend:i((()=>[d("div",O,[d("div",{innerHTML:m(_)},null,8,U)])])),_:1}),n(q,{class:"pt-2"},{default:i((()=>[z,G])),_:1}),n(q,null,{default:i((()=>[n(P,{onSubmit:c(ie,["prevent"])},{default:i((()=>[n(A,null,{default:i((()=>[n(E,{cols:"12"},{default:i((()=>[n(F,{modelValue:m(D).email,"onUpdate:modelValue":a[0]||(a[0]=e=>m(D).email=e),label:"Email",placeholder:"Enter your email",clearable:"",autocomplete:"off",onFocus:a[1]||(a[1]=e=>ee.value=!0),onBlur:oe,onInput:le},null,8,["modelValue"]),m(ee)&&m(ae).length?(o(),p(M,{key:0,class:"suggestions-list"},{default:i((()=>[(o(!0),l(v,null,g(m(ae),(e=>(o(),p(T,{key:e,onMousedown:c((a=>(e=>{D.email=e,ee.value=!1})(e)),["prevent"])},{default:i((()=>[n(B,null,{default:i((()=>[w(b(e),1)])),_:2},1024)])),_:2},1032,["onMousedown"])))),128))])),_:1})):f("",!0)])),_:1}),n(E,{cols:"12"},{default:i((()=>[n(F,{modelValue:m(D).password,"onUpdate:modelValue":a[2]||(a[2]=e=>m(D).password=e),label:"Password",placeholder:"············",type:m(se)?"text":"password","append-inner-icon":m(se)?"ri-eye-off-line":"ri-eye-line","onClick:appendInner":a[3]||(a[3]=e=>se.value=!m(se))},null,8,["modelValue","type","append-inner-icon"]),d("div",K,[n(H,{modelValue:m(D).remember,"onUpdate:modelValue":a[4]||(a[4]=e=>m(D).remember=e),label:"Remember me"},null,8,["modelValue"]),d("a",{class:"ms-2 mb-1",onClick:ue}," Forgot Password? ")]),d("div",null,[W,n(I,{block:"",type:"submit",color:"#0080ff"},{default:i((()=>[w(" Login ")])),_:1})]),m(te)?(o(),l("div",X,b(m(te)),1)):f("",!0)])),_:1}),n(E,{cols:"12",class:"text-center text-base"},{default:i((()=>[$,n(s,{class:"text-primary ms-2",to:"/register"},{default:i((()=>[w(" Create an account ")])),_:1})])),_:1}),n(E,{cols:"12",class:"d-flex align-center"},{default:i((()=>[n(J),Q,n(J)])),_:1}),n(E,{cols:"12",class:"text-center"},{default:i((()=>[n(V)])),_:1})])),_:1})])),_:1})])),_:1})])),_:1})])}}},[["__scopeId","data-v-a5d6fe46"]]);export{Y as default};
